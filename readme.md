# Biocomputing with Brainoware - Code Repository

This repository contains the code implementation for the Brainoware.

## Overview
This GITHUB code repository provides code and resources related to Brainoware's hardware properties and software framework as described in the associated Nature Protocol paper submission.

## Contents
- Procedure 2
    -  evoked response
        - [**maxlab environment**] evoked_response_MEA.py
        - [**analysis environment**] psth_plot.py
        - [**required raw file for analysis**] psth_exp_spike.csv
        - [**required raw file for analysis**] psth_exp_sti_time.csv
        - result plots and files generated by psth_plot.py
    - recurrent effects
        - [**maxlab environment**] recurrent_effects_MEA.py
    - spatial information
        - [**maxlab environment**] spatial_information.py
    - [**maxlab environment**] stimulation_example_official.py
- Procedure 3
    - [**analysis environment**] 1_information_encoding.ipynb
    - [**maxlab environment**] 2_Electrical_stimulation_and_recording.py
    - [**required raw recording file**] 2_Electrical_stimulation_and_recording_data
    *.raw.h5 [download [here](https://www.dropbox.com/scl/fi/2m520ce9z6iqisdgyrknr/speech_recognition_10hz_75mv_21680.raw.h5?rlkey=lfzxqpb2n848qpx6ts7jlzwfc&st=0pdrt5yv&dl=0) and save under this directory]
    - [**analysis environment**] 3_Information_decoding.ipynb
    - [**analysis environment**] 4_Readout_layer_training_and_prediction.ipynb
    - related datasets and result files
## Getting Started

In this protocol, two Python environments are required to finish all steps:
- maxlab environment

    Global Python environment on the PC that connects to the MaxOne High-Density Microelectrode Array (HD-MEA) System. This environment requires *maxlab*, a Python MEA stimulation library developed by MaxWell biosystems, pre-installed in the system Python package directory (â€¦/python3.8/site-packages/maxlab) to enable electrical stimulation on the MaxOne MEA recording unit through a Python script. Ask [MaxWell biosystems](https://www.mxwbio.com/) for help with maxlab environment setup (info@mxwbio.com)

    In this repository, we provided raw data resources so that you could still run through all analysis steps without dealing with maxlab environment. For huge raw recording file, download it to required repository following instructions in [Contents](#contents) part. 

- analysis environment

    Conda-based Python virtual environment for data analysis. This can be set up in any device with conda installed (See conda webpage for detailed installation guide: https://docs.conda.io/projects/conda/en/latest/index.html)

    After conda is installed:
    1. download or clone this repository
    2. open the anaconda prompt and change directory to this repository
    3. add conda-forge channel
        ```bash
        conda config --add channels conda-forge
        ```
    4. simply create a new virtual environment using provided requirements.txt file in the root of the repository:
        ```bash
        conda create --name brainoware_analysis --file requirements.txt
        ``` 
    5. activate created analysis environment
        ```bash
        conda activate brainoware_analysis
        ```
    6. Manually install spykes [credits: [KordingLab](https://github.com/KordingLab/spykes)]
        ```bash
        pip install -e .\spykes-master
        ```
    7. Install ipykernel and register the kernel in the jupyter notebook
        ```bash
        pip install ipykernel
        python -m ipykernel install --user --name=brainoware_analysis --display-name "Python (brainoware_analysis)"
        ```
    8. For files with *.py suffix, run
        ```bash
        python *.py
        ```
    9. For files with *.ipynb suffix, run
        ```bash
        jupyter notebook *.ipynb
        ```
        after entering the notebook page, select brainoware_analysis kernel in the upper right corner of the page and run the code one block by one block.
## Citation
If you're using this repository in your research, please cite the associated Nature Protocol article.

## License
See LICENSE file for details.
